<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:netsuite="http://www.mulesoft.org/schema/mule/netsuite"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:munit="http://www.mulesoft.org/schema/mule/munit"
	xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="training_task02-test-suite.xml" />
	<munit:test name="training_task02-test-suite-training_task02FlowTest" doc:id="2c2134af-45d5-4415-b746-e3d10fee0f97" description="Test">
		<munit:behavior>
			<munit-tools:mock-when doc:name="Mock when" doc:id="d1b8dd65-55fb-4edb-a656-2b81eaaa4572" processor="ftp:list">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="a2cc0253-e75e-44b0-b3e9-82a1c87c0cba" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[[{"attributes" : {"fileName": "shopData_2020-03-24_14.18.json"}}]]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to training_task02Flow" doc:id="a173538c-952e-4ea5-83e0-f2e534d6acc8" name="training_task02Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="51f2854a-ece1-40de-88f7-c7f3ce820b3f" >
				<munit-tools:that ><![CDATA[#[import * from dw::test::Asserts 
 ---
payload must [
	beArray(),
	payload[0] must equalTo("shopData_2020-03-24_14.18.json")
	]]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
	<munit:test name="training_task02-test-suiteTest" doc:id="a4317d32-54f4-4bbe-96c6-0819e03d24b2" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock List from FTP Error" doc:id="cba4a6f3-90ce-497e-9fdd-b266c578a2db" processor="ftp:list">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="a2cc0253-e75e-44b0-b3e9-82a1c87c0cba" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:error typeId="FTP:ACCESS_DENIED" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow Reference" doc:id="24c2bfee-ca7c-43d4-b503-64d6e88c4efd" name="training_task02Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:verify-call doc:name="Verify call" doc:id="9f6b6dc8-4289-4804-94c6-6c28314875ac" processor="logger" atLeast="1">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="6b831a16-143f-4f64-9331-d5756b55a962" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
		</munit:validation>
	</munit:test>
	<munit:test name="training_task02-test-suiteTest1" doc:id="5ef81d8c-db1f-485d-8dff-c216bb5443ed" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="2fb76919-9d89-4341-b173-86e670f95889" processor="ftp:list">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="a2cc0253-e75e-44b0-b3e9-82a1c87c0cba" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:error typeId="FTP:ILLEGAL_PATH" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow Reference" doc:id="3c2e18fc-bc08-4e48-b6b8-2a517bea02b9" name="training_task02Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:verify-call doc:name="Verify call" doc:id="6f49ca87-c11e-48ba-90ce-5910989cfbb5" processor="logger" atLeast="1">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="7ffaec69-8921-4c89-930f-e205becae09b" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
		</munit:validation>
	</munit:test>


</mule>
